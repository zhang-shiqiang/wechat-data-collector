# 微信扫码登录配置说明

## 功能说明

通过微信扫码登录，可以：
1. 提升用户体验，快速登录
2. 获取用户微信信息（昵称、头像等）
3. 在获取文章时，可以尝试使用微信API获取更准确的数据

## 配置步骤

### 1. 注册微信开放平台账号

访问：https://open.weixin.qq.com/

1. 注册并登录微信开放平台
2. 创建网站应用
3. 填写应用信息：
   - 应用名称：微信公众号管理阅读器
   - 应用简介：统一管理微信公众号文章
   - 应用官网：填写你的网站地址
   - 应用图标：上传应用图标

### 2. 配置授权回调域名

在应用详情页面，配置"授权回调域名"：
- **重要**：只需要填写域名，不需要填写完整URL
- 开发环境：`localhost:3000`（只填写域名和端口）
- 生产环境：你的实际域名（如：`yourdomain.com`，不需要 `http://` 和路径）

**回调地址说明**：
- 授权回调域名配置为：`localhost:3000`
- 实际回调URL为：`http://localhost:3000/api/wechat/callback`
- 微信会自动在配置的域名下调用回调地址

### 3. 获取 AppID 和 AppSecret

在应用详情页面，可以获取：
- **AppID**：应用唯一标识
- **AppSecret**：应用密钥（需要妥善保管）

### 4. 配置环境变量

在 `backend` 目录下创建 `.env` 文件（或修改现有文件），添加：

```env
WECHAT_APP_ID=你的AppID
WECHAT_APP_SECRET=你的AppSecret
```

### 5. 重启后端服务

配置完成后，重启后端服务使配置生效。

## 注意事项

1. **权限限制**：
   - 微信开放平台API通常只能获取用户自己创建的公众号的文章
   - 对于其他公众号，仍然需要使用爬虫方式获取文章

2. **回调地址**：
   - 确保回调地址与配置的授权回调域名一致
   - 回调地址格式：`http://yourdomain.com/auth/wechat/callback`

3. **安全性**：
   - AppSecret 是敏感信息，不要提交到代码仓库
   - 建议使用环境变量或密钥管理服务

## 使用方式

1. 在登录页面点击"微信扫码登录"按钮
2. 使用微信扫描二维码
3. 在手机上确认登录
4. 登录成功后自动跳转到首页

## 技术实现

- 使用微信开放平台 OAuth2.0 扫码登录
- 前端显示二维码，用户扫码后跳转到回调地址
- 后端通过 code 换取 access_token，再获取用户信息
- 自动创建或更新用户账户

